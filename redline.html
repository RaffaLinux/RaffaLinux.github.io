<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio - Projects</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            color: #333;
        }
        header {
            background-color: #333;
            color: white;
            padding: 1rem 0;
            text-align: center;
        }
        header h1 {
            margin: 0;
        }
        nav {
            background-color: #444;
            text-align: center;
            padding: 0.5rem 0;
        }
        nav a {
            color: white;
            text-decoration: none;
            margin: 0 1rem;
        }
        nav a:hover {
            text-decoration: underline;
        }
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .projects-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        }
        .project {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        .project img {
            width: calc(100% + 2rem); /* Expands image to compensate for padding */
            height: auto;
            margin: -1rem -1rem 1rem -1rem; /* Negates padding for full width */
            border-radius: 8px 8px 0 0; /* Keeps top corners rounded */
        }
        .project h2 {
            margin: 0.5rem 0;
            font-size: 1rem;
        }
        .project p {
            font-size: 0.9rem;
            line-height: 1.4;
            margin: 0;
        }
        .project a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            margin-top: 0.5rem;
            display: inline-block;
        }
        .project a:hover {
            text-decoration: underline;
        }
        .publication {
            background: white;
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        body {
            font-family: monospace;
            background-color: #1e1e1e;
            color: #ffffff;
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            border: 2px solid #888;
        }
        th, td {
            border: 1px solid #888;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #444;
        }
        .section-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        .publication h3 {
            margin: 0;
            font-size: 1.2rem;
        }
        .publication p {
            margin: 0.5rem 0 0;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .contacts {
            text-align: center;
            margin-top: 1rem;
            padding: 0.2rem;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        .contacts p {
            margin: 0.5rem 0;
            font-size: 1rem;
        }
        .contacts a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
        }
        .contacts a:hover {
            text-decoration: underline;
        }
        footer {
            text-align: center;
            padding: 1rem 0;
            background-color: #333;
            color: white;
        }
        .gallery-item {
                width: 300px;
                height: auto;
            cursor: pointer;
        }
        footer a {
            color: #007bff;
        }
        @media (max-width: 768px) {
            .project img {
                height: auto;
            }
        }
    </style>
                
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const galleryItems = document.querySelectorAll('.gallery-item');
                        galleryItems.forEach(item => {
                            // Wrap each image in a container
                            const container = document.createElement('div');
                            container.style.position = 'relative';
                            container.style.display = 'inline-block';
                            container.style.margin = '10px';
                            
                            // Create zoom icon
                            const zoomIcon = document.createElement('i');
                            zoomIcon.className = 'fas fa-search-plus';
                            zoomIcon.style.position = 'absolute';
                            zoomIcon.style.top = '10px';
                            zoomIcon.style.right = '10px';
                            zoomIcon.style.color = 'white';
                            zoomIcon.style.fontSize = '20px';
                            zoomIcon.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
                            zoomIcon.style.borderRadius = '50%';
                            zoomIcon.style.padding = '5px';
                            
                            // Append image and zoom icon to container
                            container.appendChild(item.cloneNode());
                            container.appendChild(zoomIcon);
                            item.parentNode.replaceChild(container, item);
                            
                            container.addEventListener('click', function() {
                                const modal = document.createElement('div');
                                modal.style.position = 'fixed';
                                modal.style.top = '0';
                                modal.style.left = '0';
                                modal.style.width = '100%';
                                modal.style.height = '100%';
                                modal.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
                                modal.style.display = 'flex';
                                modal.style.alignItems = 'center';
                                modal.style.justifyContent = 'center';
                                modal.style.zIndex = '1000';
                                
                                const img = document.createElement('img');
                                img.src = container.querySelector('img').src;
                                img.style.maxWidth = '90%';
                                img.style.maxHeight = '90%';
                                img.style.border = '2px solid white';
                                
                                modal.appendChild(img);
                                document.body.appendChild(modal);
                                
                                modal.addEventListener('click', function() {
                                    document.body.removeChild(modal);
                    });
                    });
                });
                });
            </script>
</head>
<body>
    <header>
        <h1>Raffaele Carillo's Portfolio</h1>
    </header>
    
    <nav>
        <a href="./index.html">Home</a>
        <a href="./index.html#about">Who am I?</a>
        <a href="./index.html#projects">Projects</a>
        <a href="./index.html#publications">Publications</a>
        <a href="./index.html#contact">Contacts</a>
    </nav>

    <div class="container">
        <h1>Redline Infostealer Analysis</h1>
        <h2>Introduction</h2>
        <p>Redline is a malware family that has been active since 2012. It is a data stealer that is capable of exfiltrating sensitive information from the victim's machine. The malware is written in C++ and is often packed with a custom packer and loaded on the victim's machine through various loading and defense evasion mechanisms. The malware is capable of stealing sensitive information such as credentials, cookies, and browser history. The malware is also capable of taking screenshots of the victim's machine.</p>
        <h2>First stage: Downloader</h2>
        <h3>Basic static analysis</h3>
        <p>The sample under analysis (<b>SHA1:d6ae1c5d0bf5d7784c775ee833ec63756c77bdae</b>) is flagged as a generic Trojan Downloade by most AV suites or as Fareit by some of them. It is a EXE file built for x86-64 Windows systems.
        We first analyze its capabilities using capa. The output of the tool is shown below:</p>

        <div id="" style="overflow:scroll; height:400px;">
            <div class="section-title">File Information</div>
            <table>
                <tbody>
                    <tr><th>md5</th><td>ae81456496d974ac77aa11fcd2de8b0f</td></tr>
                    <tr><th>sha1</th><td>d6ae1c5d0bf5d7784c775ee833ec63756c77bdae</td></tr>
                    <tr><th>sha256</th><td>81be001c01d1fae33deab1c542661e90f07be5ae168f8220415063d26cd578ca</td></tr>
                    <tr><th>analysis</th><td>static</td></tr>
                    <tr><th>os</th><td>windows</td></tr>
                    <tr><th>format</th><td>pe</td></tr>
                    <tr><th>arch</th><td>amd64</td></tr>
                    <tr><th>path</th><td>C:/Users/User/Downloads/81be001c01d1fae33deab1c542661e90f07be5ae168f8220415063d26cd578ca.exe</td></tr>
                </tbody>
            </table>
        
            <div class="section-title">ATT&CK Mapping</div>
            <table>
                <thead>
                    <tr><th>ATT&CK Tactic</th><th>ATT&CK Technique</th></tr>
                </thead>
                <tbody>
                    <tr><td>DEFENSE EVASION</td><td>Obfuscated Files or Information::Indicator Removal from Tools [T1027.005]</td></tr>
                    <tr><td>DISCOVERY</td><td>System Information Discovery [T1082]</td></tr>
                    <tr><td>EXECUTION</td><td>Shared Modules [T1129]</td></tr>
                    <tr><td>PERSISTENCE</td><td>Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]</td></tr>
                </tbody>
            </table>
        
            <div class="section-title">MBC Mapping</div>
            <table>
                <thead>
                    <tr><th>MBC Objective</th><th>MBC Behavior</th></tr>
                </thead>
                <tbody>
                    <tr><td>ANTI-STATIC ANALYSIS</td><td>Executable Code Obfuscation::Argument Obfuscation [B0032.020]</td></tr>
                    <tr><td></td><td>Executable Code Obfuscation::Stack Strings [B0032.017]</td></tr>
                    <tr><td>COMMUNICATION</td><td>HTTP Communication [C0002]</td></tr>
                    <tr><td></td><td>HTTP Communication::Read Header [C0002.014]</td></tr>
                    <tr><td>DISCOVERY</td><td>Analysis Tool Discovery::Process detection [B0013.001]</td></tr>
                    <tr><td></td><td>Code Discovery::Enumerate PE Sections [B0046.001]</td></tr>
                    <tr><td></td><td>System Information Discovery [E1082]</td></tr>
                    <tr><td>PERSISTENCE</td><td>Registry Run Keys / Startup Folder [F0012]</td></tr>
                </tbody>
            </table>
        
            <div class="section-title">Capabilities</div>
            <table>
                <thead>
                    <tr><th>Capability</th><th>Namespace</th></tr>
                </thead>
                <tbody>
                    <tr><td>reference analysis tools strings</td><td>anti-analysis</td></tr>
                    <tr><td>contain obfuscated stackstrings</td><td>anti-analysis/obfuscation/string/stackstring</td></tr>
                    <tr><td>reference HTTP User-Agent string</td><td>communication/http</td></tr>
                    <tr><td>check HTTP status code</td><td>communication/http/client</td></tr>
                    <tr><td>check OS version</td><td>host-interaction/os/version</td></tr>
                    <tr><td>link function at runtime on Windows</td><td>linking/runtime-linking</td></tr>
                    <tr><td>enumerate PE sections (2 matches)</td><td>load-code/pe</td></tr>
                    <tr><td>resolve function by parsing PE exports (2 matches)</td><td>load-code/pe</td></tr>
                    <tr><td>persist via Run registry key</td><td>persistence/registry/run</td></tr>
                </tbody>
            </table>
            </div>
            
            <p>We can see that it has some basic capabilities such as comunicate with a HTTP server as well as to establish persistence using the Registry run key as well to detect processes for Anti-Analysis purposes.</p>
            <p>Next, we will analyze the strings of the sample using DetectItEasy. The output of the tool is shown below:</p>
            
            <img src="./redlineAnalysis/strings1.png" alt="Redline strings analysis" class="gallery-item">
            <p>We can see that the sample contains strings relative to the aforementioned techniques, such as an URL for the C2 server  to a dll named "<b>bot.dll</b>" (SHA1: 78bdad1cf98759ec9dbcc1888cdaa2f7fccfcdbc). Its IP - "<b>176.113.115.149</b>" - refers to a server loacted in Russia. The process names of famous analysis tools such as <b>x64dbg</b> and <b>Process Hacker</b> are also present, presumably to evade analysis. It also makes use the registry run key to achieve persistence. Additionally, it mentions <b>explorer.exe</b> probably to achieve process injection. Finally, the use of reflection to load the malware is also probably exploited.</p>
            <p>The PE of the executable contains six sections beside the Header and the entropy measurement indicates that none of them are packed. The sample was compiled with Microsoft Visual C/C++ (17.00.50727) [C++], linked with Microsoft Linker (11.00.50727) and written using Visual Studio 2012.</p>
        <h3>Basic dynamic analysis</h3>
        <p>Next, we analyze the sample by running it in a controlled environment. We use <b>Process Monitor</b> to monitor the file system, registry, and, with also <b>Wireshark</b>, network activity of the sample. To analyse the sample, it's anti-analysis functions were patched so to not detect the analysis tools. The output of the tool is shown below:</p>
            <img src="./redlineAnalysis/botDownloadWireshark.png" alt="Redline strings analysis" class="gallery-item">
            <img src="./redlineAnalysis/procmondownloader1.png" alt="Redline strings analysis" class="gallery-item">
            <img src="./redlineAnalysis/procmondownloader2.png" alt="Redline strings analysis" class="gallery-item">


        <p>After this, the malware relaunches itself as "<b>msiexec.exe</b>" after setting environment variables. Also it downloads a .exe file with a temp name to %AppData%.</p> 
        <p>Then a whole suite of malicious executables are downloaded and executed on the system. In particular the following .exe are downloaded</p>
        <li>nvc.exe - SHA1: 40d5d83a04d33347431128338490615d4390088c</li>
        <li>svc.exe - SHA1: d0639a290e178e152e50b50c185d08f79ab52629</li>
        <li>z.exe - SHA1: bf9339f46d7a33d342aeb7fca8b5d5fb8b4d165a</li>
        <li>zx.exe - SHA1: 8e0b84d2d362126d157ad9e50d295a18427af8e0</li>
        <li>update.exe - SHA1: bf9339f46d7a33d342aeb7fca8b5d5fb8b4d165a</li>
        <img src="./redlineAnalysis/malwareDownloadsWireshark.png" alt="Redline strings analysis" class="gallery-item">

        <p>While an in depth analysis for each of these files was not carried, it can be said that each has a set of exported functions or internal routines that aim to steal data in different ways, including scanning user folders, capturing screenshots, injecting web pages, and stealing cookie. Each of these executables has capabilities to send data to the C2 server independently. <br> We observe evidence of that in the Procmon logs, which indicates that one of these samples collected screenshots and builded in its install path - %ProgramData% - a set of folders regarding famous programs of various categories (including FTP clients, and Messaging apps) and then packed the logs to a .zip file and then uploaded it.</p>
        <img src="./redlineAnalysis/malwareDownload (8).png" alt="Redline strings analysis" class="gallery-item">
        <img src="./redlineAnalysis/malwareDownload (9).png" alt="Redline strings analysis" class="gallery-item">

        <h3>Advanced static analysis</h3>

        <h2>Second stage: Bot</h2>


        <div id="" style="overflow:scroll; height:400px;">
            <div class="section-title">File Information</div>
            <table>
                <tbody>
                    <tr><th>md5</th><td>245749553e7194636b0f78e7dea115ef</td></tr>
                    <tr><th>sha1</th><td>78bdad1cf98759ec9dbcc1888cdaa2f7fccfcdbc</td></tr>
                    <tr><th>sha256</th><td>4b7e4232fec31a80cdccada106516e45a38d97ae18fbba586d4bec41c0bad823</td></tr>
                    <tr><th>analysis</th><td>static</td></tr>
                    <tr><th>os</th><td>windows</td></tr>
                    <tr><th>format</th><td>pe</td></tr>
                    <tr><th>arch</th><td>amd64</td></tr>
                    <tr><th>path</th><td>C:/Users/User/Downloads/bot.dll</td></tr>
                </tbody>
            </table>
        
            <div class="section-title">ATT&CK Mapping</div>
            <table>
                <thead>
                    <tr><th>ATT&CK Tactic</th><th>ATT&CK Technique</th></tr>
                </thead>
                <tbody>
                    <tr><td>COLLECTION</td><td>Archive Collected Data::Archive via Library [T1560.002]</td></tr>
                    <tr><td rowspan="6">DEFENSE EVASION</td><td>File and Directory Permissions Modification [T1222]</td></tr>
                    <tr><td>Obfuscated Files or Information [T1027]</td></tr>
                    <tr><td>Indicator Removal from Tools [T1027.005]</td></tr>
                    <tr><td>Process Hollowing [T1055.012]</td></tr>
                    <tr><td>Thread Execution Hijacking [T1055.003]</td></tr>
                    <tr><td>Reflective Code Loading [T1620]</td></tr>
                </tbody>
            </table>
        
            <div class="section-title">MBC Mapping</div>
            <table>
                <thead>
                    <tr><th>MBC Objective</th><th>MBC Behavior</th></tr>
                </thead>
                <tbody>
                    <tr><td>ANTI-BEHAVIORAL ANALYSIS</td><td>Debugger Detection::Software Breakpoints [B0001.025]</td></tr>
                    <tr><td rowspan="2">ANTI-STATIC ANALYSIS</td><td>Executable Code Obfuscation::Argument Obfuscation [B0032.020]</td></tr>
                    <tr><td>Executable Code Obfuscation::Stack Strings [B0032.017]</td></tr>
                </tbody>
            </table>
        
            <div class="section-title">Capabilities</div>
            <table>
                <thead>
                    <tr><th>Capability</th><th>Namespace</th></tr>
                </thead>
                <tbody>
                    <tr><td>check for software breakpoints (2 matches)</td><td>anti-analysis/anti-debugging/debugger-detection</td></tr>
                    <tr><td>contain obfuscated stackstrings</td><td>anti-analysis/obfuscation/string/stackstring</td></tr>
                    <tr><td>parse credit card information</td><td>collection/credit-card</td></tr>
                </tbody>
            </table>
            </div>

        
    </div>
        <footer>
            <p>&copy; 2025 Raffaele Carillo. <a href="https://github.com/tuo-username">GitHub</a></p>
        </footer>
    </body>
    </html>
